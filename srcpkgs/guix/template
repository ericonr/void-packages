# Template file for 'guix'
pkgname=guix
version=1.1.0
revision=1
build_style=gnu-configure
configure_args="--with-bash-completion-dir=${DESTDIR}/usr/share/bash-completion/completions
 --with-fish-completion-dir=${DESTDIR}/usr/share/fish/vendor_completions.d
 --with-zsh-completion-dir=${DESTDIR}/usr/share/zsh/site_functions"
hostmakedepends="guile3 pkg-config"
_guile_libs="gnutls guile-git guile-json guile-sqlite3 guile-gcrypt guile-ssh"
makedepends="gnutls-devel guile3-devel ${_guile_libs} zlib-devel"
depends="guile3 ${_guile_libs}"
short_desc="Package management tool for the GNU system"
maintainer="Ã‰rico Nogueira <ericonr@disroot.org>"
license="GPL-3.0-or-later"
homepage="https://guix.gnu.org/"
distfiles="${GNU_SITE}/${pkgname}/${pkgname}-${version}.tar.gz"
checksum=5c59106ff4ac497c6097686834b0c914109cf5e44eb6b94ebce818923043640f

if [ "$XBPS_TARGET_LIBC" = "musl" ]; then
	broken="Guix doesn't support musl"
fi

if [ "$CROSS_BUILD" ]; then
	hostmakedepends+=" ${_guile_libs}"
fi

post_install() {
	vsv guix-daemon
}
